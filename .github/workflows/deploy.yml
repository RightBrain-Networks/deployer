name: deployer-actions
on:
  release:
    types: [ published ]
env:
  GITHUB_URL: 'git@github.com:RightBrain-Networks/deployer.git'
  GITHUB_KEY: 'rbn-ops github'

  SERVICE: 'deployer'
  SELF_SEMVER_TAG: "master"

  AWS_DEFAULT_REGION: "us-east-1"
  AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY }}
  AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
jobs:
  release:
          runs-on: ubuntu-latest
          needs: [ build ]
          if: startsWith(github.ref, 'refs/tags') != true
          steps:
            - name: Download artifact
              id: download-artifact
              uses: dawidd6/action-download-artifact@v2
              with:
                github_token: ${{secrets.GITHUB_TOKEN}}
                workflow: build.yml
                workflow_conclusion: success
                commit: ${{github.event.sha}}
                name: deployer-${{github.ref_name}}.tar
                if_no_artifact_found: fail
            - name: Set Up Git Config
              run: |
                git config user.name "GitHub Actions Bot"
                git config user.email "<>"
